

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>selfisys.utils package &mdash; SelfiSys /Users/hoellinger/Library/CloudStorage/Dropbox/travail/these/science/code/SELFI/selfisys/src/ documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=75025241"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to SelfiSys" href="CONTRIBUTING.html" />
    <link rel="prev" title="grf" href="selfisys.grf.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SelfiSys
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="selfisys.hiddenbox.html">hiddenbox</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox"><code class="docutils literal notranslate"><span class="pre">HiddenBox</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.Npop"><code class="docutils literal notranslate"><span class="pre">HiddenBox.Npop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.Ntimesteps"><code class="docutils literal notranslate"><span class="pre">HiddenBox.Ntimesteps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.Psingle"><code class="docutils literal notranslate"><span class="pre">HiddenBox.Psingle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.compute_pool"><code class="docutils literal notranslate"><span class="pre">HiddenBox.compute_pool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.evaluate"><code class="docutils literal notranslate"><span class="pre">HiddenBox.evaluate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.force_neglect_lightcone"><code class="docutils literal notranslate"><span class="pre">HiddenBox.force_neglect_lightcone</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.force_recompute_mocks"><code class="docutils literal notranslate"><span class="pre">HiddenBox.force_recompute_mocks</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.gravity_on"><code class="docutils literal notranslate"><span class="pre">HiddenBox.gravity_on</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.load_pool"><code class="docutils literal notranslate"><span class="pre">HiddenBox.load_pool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.make_data"><code class="docutils literal notranslate"><span class="pre">HiddenBox.make_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.modified_selfi"><code class="docutils literal notranslate"><span class="pre">HiddenBox.modified_selfi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.prefix_mocks"><code class="docutils literal notranslate"><span class="pre">HiddenBox.prefix_mocks</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.reset_survey"><code class="docutils literal notranslate"><span class="pre">HiddenBox.reset_survey()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.setup_only"><code class="docutils literal notranslate"><span class="pre">HiddenBox.setup_only</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.switch_recompute_pool"><code class="docutils literal notranslate"><span class="pre">HiddenBox.switch_recompute_pool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.switch_setup"><code class="docutils literal notranslate"><span class="pre">HiddenBox.switch_setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.hiddenbox.html#selfisys.hiddenbox.HiddenBox.update"><code class="docutils literal notranslate"><span class="pre">HiddenBox.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selfisys.normalise_hb.html">normalise_hb</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.normalise_hb.html#selfisys.normalise_hb.define_normalisation"><code class="docutils literal notranslate"><span class="pre">define_normalisation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.normalise_hb.html#selfisys.normalise_hb.worker_normalisation"><code class="docutils literal notranslate"><span class="pre">worker_normalisation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.normalise_hb.html#selfisys.normalise_hb.worker_normalisation_public"><code class="docutils literal notranslate"><span class="pre">worker_normalisation_public()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.normalise_hb.html#selfisys.normalise_hb.worker_normalisation_wrapper"><code class="docutils literal notranslate"><span class="pre">worker_normalisation_wrapper()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selfisys.prior.html">prior</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.get_summary"><code class="docutils literal notranslate"><span class="pre">get_summary()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.logposterior_hyperparameters_parallel"><code class="docutils literal notranslate"><span class="pre">logposterior_hyperparameters_parallel()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.perform_prior_optimisation_and_plot"><code class="docutils literal notranslate"><span class="pre">perform_prior_optimisation_and_plot()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior"><code class="docutils literal notranslate"><span class="pre">planck_prior</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.mean"><code class="docutils literal notranslate"><span class="pre">planck_prior.mean</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.covariance"><code class="docutils literal notranslate"><span class="pre">planck_prior.covariance</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.inv_covariance"><code class="docutils literal notranslate"><span class="pre">planck_prior.inv_covariance</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.Nbin_max"><code class="docutils literal notranslate"><span class="pre">planck_prior.Nbin_max</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.Nbin_min"><code class="docutils literal notranslate"><span class="pre">planck_prior.Nbin_min</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.compute"><code class="docutils literal notranslate"><span class="pre">planck_prior.compute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.load"><code class="docutils literal notranslate"><span class="pre">planck_prior.load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.logpdf"><code class="docutils literal notranslate"><span class="pre">planck_prior.logpdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.sample"><code class="docutils literal notranslate"><span class="pre">planck_prior.sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.planck_prior.save"><code class="docutils literal notranslate"><span class="pre">planck_prior.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.prior.html#selfisys.prior.worker_class"><code class="docutils literal notranslate"><span class="pre">worker_class()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selfisys.selection_functions.html">selection_functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection"><code class="docutils literal notranslate"><span class="pre">LognormalSelection</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.init_selection"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.init_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.lognormals_z_to_x"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.lognormals_z_to_x()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.multiple_lognormal"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.multiple_lognormal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.multiple_lognormal_z"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.multiple_lognormal_z()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.one_lognormal"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.one_lognormal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.one_lognormal_z"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.one_lognormal_z()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="selfisys.selection_functions.html#selfisys.selection_functions.LognormalSelection.r_grid"><code class="docutils literal notranslate"><span class="pre">LognormalSelection.r_grid()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selfisys.selfi_interface.html">selfi_interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.selfi_interface.html#selfisys.selfi_interface.PrintMessage"><code class="docutils literal notranslate"><span class="pre">PrintMessage()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.selfi_interface.html#selfisys.selfi_interface.indent"><code class="docutils literal notranslate"><span class="pre">indent()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.selfi_interface.html#selfisys.selfi_interface.unindent"><code class="docutils literal notranslate"><span class="pre">unindent()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selfisys.sbmy_interface.html">sbmy_interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.sbmy_interface.html#selfisys.sbmy_interface.compute_Phi"><code class="docutils literal notranslate"><span class="pre">compute_Phi()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.sbmy_interface.html#selfisys.sbmy_interface.generate_white_noise_Field"><code class="docutils literal notranslate"><span class="pre">generate_white_noise_Field()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.sbmy_interface.html#selfisys.sbmy_interface.get_power_spectrum_from_cosmo"><code class="docutils literal notranslate"><span class="pre">get_power_spectrum_from_cosmo()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.sbmy_interface.html#selfisys.sbmy_interface.handle_time_stepping"><code class="docutils literal notranslate"><span class="pre">handle_time_stepping()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="selfisys.sbmy_interface.html#selfisys.sbmy_interface.setup_sbmy_parfiles"><code class="docutils literal notranslate"><span class="pre">setup_sbmy_parfiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selfisys.grf.html">grf</a><ul>
<li class="toctree-l2"><a class="reference internal" href="selfisys.grf.html#selfisys.grf.primordial_grf"><code class="docutils literal notranslate"><span class="pre">primordial_grf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">selfisys.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.examples_utils">selfisys.utils.examples_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.examples_utils.clear_large_plot"><code class="docutils literal notranslate"><span class="pre">clear_large_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.logger">selfisys.utils.logger module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.CustomLogger"><code class="docutils literal notranslate"><span class="pre">CustomLogger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selfisys.utils.logger.CustomLogger.diagnostic"><code class="docutils literal notranslate"><span class="pre">CustomLogger.diagnostic()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.CustomLoggerHandler"><code class="docutils literal notranslate"><span class="pre">CustomLoggerHandler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selfisys.utils.logger.CustomLoggerHandler.emit"><code class="docutils literal notranslate"><span class="pre">CustomLoggerHandler.emit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.INDENT"><code class="docutils literal notranslate"><span class="pre">INDENT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.PrintDiagnostic"><code class="docutils literal notranslate"><span class="pre">PrintDiagnostic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.PrintError"><code class="docutils literal notranslate"><span class="pre">PrintError()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.PrintInfo"><code class="docutils literal notranslate"><span class="pre">PrintInfo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.PrintLeftType"><code class="docutils literal notranslate"><span class="pre">PrintLeftType()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.PrintWarning"><code class="docutils literal notranslate"><span class="pre">PrintWarning()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.UNINDENT"><code class="docutils literal notranslate"><span class="pre">UNINDENT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.logger.getCustomLogger"><code class="docutils literal notranslate"><span class="pre">getCustomLogger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.low_level">selfisys.utils.low_level module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.low_level.stderr_redirector"><code class="docutils literal notranslate"><span class="pre">stderr_redirector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.low_level.stdout_redirector"><code class="docutils literal notranslate"><span class="pre">stdout_redirector()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.parser">selfisys.utils.parser module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.bool_sh"><code class="docutils literal notranslate"><span class="pre">bool_sh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.check_files_exist"><code class="docutils literal notranslate"><span class="pre">check_files_exist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.intNone"><code class="docutils literal notranslate"><span class="pre">intNone()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.joinstrs"><code class="docutils literal notranslate"><span class="pre">joinstrs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.joinstrs_only"><code class="docutils literal notranslate"><span class="pre">joinstrs_only()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.none_or_bool_or_str"><code class="docutils literal notranslate"><span class="pre">none_or_bool_or_str()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.parser.safe_npload"><code class="docutils literal notranslate"><span class="pre">safe_npload()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.path_utils">selfisys.utils.path_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.path_utils.file_names_evaluate"><code class="docutils literal notranslate"><span class="pre">file_names_evaluate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.path_utils.get_file_names"><code class="docutils literal notranslate"><span class="pre">get_file_names()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.plot_examples">selfisys.utils.plot_examples module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_examples.plot_comoving_distance_redshift"><code class="docutils literal notranslate"><span class="pre">plot_comoving_distance_redshift()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_examples.plot_galaxy_field_slice"><code class="docutils literal notranslate"><span class="pre">plot_galaxy_field_slice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_examples.plot_power_spectrum"><code class="docutils literal notranslate"><span class="pre">plot_power_spectrum()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_examples.plot_selection_functions_def_in_z"><code class="docutils literal notranslate"><span class="pre">plot_selection_functions_def_in_z()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_examples.redshift_distance_conversion"><code class="docutils literal notranslate"><span class="pre">redshift_distance_conversion()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_examples.relative_error_analysis"><code class="docutils literal notranslate"><span class="pre">relative_error_analysis()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.plot_params">selfisys.utils.plot_params module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11"><code class="docutils literal notranslate"><span class="pre">ScalarFormatterForceFormat_11</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11.get_offset"><code class="docutils literal notranslate"><span class="pre">ScalarFormatterForceFormat_11.get_offset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11.set_scientific"><code class="docutils literal notranslate"><span class="pre">ScalarFormatterForceFormat_11.set_scientific()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11.set_useOffset"><code class="docutils literal notranslate"><span class="pre">ScalarFormatterForceFormat_11.set_useOffset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.create_all_colormaps"><code class="docutils literal notranslate"><span class="pre">create_all_colormaps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.create_colormap"><code class="docutils literal notranslate"><span class="pre">create_colormap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.dynamic_text_scaling"><code class="docutils literal notranslate"><span class="pre">dynamic_text_scaling()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.get_contours"><code class="docutils literal notranslate"><span class="pre">get_contours()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.reset_plotting"><code class="docutils literal notranslate"><span class="pre">reset_plotting()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_params.setup_plotting"><code class="docutils literal notranslate"><span class="pre">setup_plotting()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.plot_utils">selfisys.utils.plot_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_C"><code class="docutils literal notranslate"><span class="pre">plot_C()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_fisher"><code class="docutils literal notranslate"><span class="pre">plot_fisher()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_gradients"><code class="docutils literal notranslate"><span class="pre">plot_gradients()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_histogram"><code class="docutils literal notranslate"><span class="pre">plot_histogram()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_mocks"><code class="docutils literal notranslate"><span class="pre">plot_mocks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_mocks_compact"><code class="docutils literal notranslate"><span class="pre">plot_mocks_compact()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_observations"><code class="docutils literal notranslate"><span class="pre">plot_observations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_prior_and_posterior_covariances"><code class="docutils literal notranslate"><span class="pre">plot_prior_and_posterior_covariances()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_reconstruction"><code class="docutils literal notranslate"><span class="pre">plot_reconstruction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plot_selection_functions"><code class="docutils literal notranslate"><span class="pre">plot_selection_functions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.plot_utils.plotly_3d"><code class="docutils literal notranslate"><span class="pre">plotly_3d()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.timestepping">selfisys.utils.timestepping module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.timestepping.merge_nTS"><code class="docutils literal notranslate"><span class="pre">merge_nTS()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.tools">selfisys.utils.tools module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.cosmo_vector_to_Simbelmyne_dict"><code class="docutils literal notranslate"><span class="pre">cosmo_vector_to_Simbelmyne_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.cosmo_vector_to_class_dict"><code class="docutils literal notranslate"><span class="pre">cosmo_vector_to_class_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.custom_stat"><code class="docutils literal notranslate"><span class="pre">custom_stat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.fisher_rao"><code class="docutils literal notranslate"><span class="pre">fisher_rao()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.get_k_max"><code class="docutils literal notranslate"><span class="pre">get_k_max()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.get_summary"><code class="docutils literal notranslate"><span class="pre">get_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.none_or_bool_or_str"><code class="docutils literal notranslate"><span class="pre">none_or_bool_or_str()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.params_ids_to_Simbelmyne_dict"><code class="docutils literal notranslate"><span class="pre">params_ids_to_Simbelmyne_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.sample_omega_from_prior"><code class="docutils literal notranslate"><span class="pre">sample_omega_from_prior()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.tools.summary_to_score"><code class="docutils literal notranslate"><span class="pre">summary_to_score()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils.workers">selfisys.utils.workers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.workers.Simbelmyne_worker"><code class="docutils literal notranslate"><span class="pre">Simbelmyne_worker()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.workers.evaluate_gradient_of_Symbelmyne"><code class="docutils literal notranslate"><span class="pre">evaluate_gradient_of_Symbelmyne()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#selfisys.utils.workers.worker_gradient_Symbelmyne"><code class="docutils literal notranslate"><span class="pre">worker_gradient_Symbelmyne()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-selfisys.utils">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribute</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing to SelfiSys</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html#reporting-issues">Reporting Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html#submitting-contributions">Submitting Contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html#style-guidelines">Style Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CONTRIBUTING.html#python-code">Python code</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONTRIBUTING.html#jupyter-notebooks">Jupyter Notebooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html#questions">Questions?</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="REFERENCES.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SelfiSys</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">selfisys.utils package</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/hoellin/selfisys_public/blob/main/docs/source/selfisys.utils.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="selfisys-utils-package">
<h1>selfisys.utils package<a class="headerlink" href="#selfisys-utils-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-selfisys.utils.examples_utils">
<span id="selfisys-utils-examples-utils-module"></span><h2>selfisys.utils.examples_utils module<a class="headerlink" href="#module-selfisys.utils.examples_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.examples_utils.clear_large_plot">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.examples_utils.</span></span><span class="sig-name descname"><span class="pre">clear_large_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/examples_utils.html#clear_large_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.examples_utils.clear_large_plot" title="Link to this definition"></a></dt>
<dd><p>Clear a figure to free up memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – The figure to clear.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.logger">
<span id="selfisys-utils-logger-module"></span><h2>selfisys.utils.logger module<a class="headerlink" href="#module-selfisys.utils.logger" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="selfisys.utils.logger.CustomLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">CustomLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#CustomLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.CustomLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></p>
<p>Custom logger class supporting custom verbosity levels in diagnostic
messages.</p>
<dl class="py method">
<dt class="sig sig-object py" id="selfisys.utils.logger.CustomLogger.diagnostic">
<span class="sig-name descname"><span class="pre">diagnostic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/selfisys/utils/logger.html#CustomLogger.diagnostic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.CustomLogger.diagnostic" title="Link to this definition"></a></dt>
<dd><p>Log a message with DIAGNOSTIC level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – The message to log.</p></li>
<li><p><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em>) – The verbosity level required to log this message.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="selfisys.utils.logger.CustomLoggerHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">CustomLoggerHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#CustomLoggerHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.CustomLoggerHandler" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Handler</span></code></p>
<p>Custom logging handler to redirect Python logger messages to custom
print functions, with support for verbosity levels in debug
messages.</p>
<dl class="py method">
<dt class="sig sig-object py" id="selfisys.utils.logger.CustomLoggerHandler.emit">
<span class="sig-name descname"><span class="pre">emit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#CustomLoggerHandler.emit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.CustomLoggerHandler.emit" title="Link to this definition"></a></dt>
<dd><p>Emit a log record.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.INDENT">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">INDENT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#INDENT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.INDENT" title="Link to this definition"></a></dt>
<dd><p>Indents the current level of outputs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.PrintDiagnostic">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">PrintDiagnostic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbosity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#PrintDiagnostic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.PrintDiagnostic" title="Link to this definition"></a></dt>
<dd><p>Prints a diagnostic to screen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>int</strong><strong>)</strong> (<em>verbosity</em>)</p></li>
<li><p><strong>(</strong><strong>string</strong><strong>)</strong> (<em>message</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.PrintError">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">PrintError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#PrintError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.PrintError" title="Link to this definition"></a></dt>
<dd><p>Prints an error to screen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(</strong><strong>string</strong><strong>)</strong> (<em>message</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.PrintInfo">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">PrintInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#PrintInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.PrintInfo" title="Link to this definition"></a></dt>
<dd><p>Prints an information to screen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(</strong><strong>string</strong><strong>)</strong> (<em>message</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.PrintLeftType">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">PrintLeftType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FONT_COLOR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#PrintLeftType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.PrintLeftType" title="Link to this definition"></a></dt>
<dd><p>Prints the type of output to screen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>string</strong><strong>)</strong> (<em>FONT_COLOR</em>)</p></li>
<li><p><strong>(</strong><strong>string</strong><strong>)</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.PrintWarning">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">PrintWarning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#PrintWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.PrintWarning" title="Link to this definition"></a></dt>
<dd><p>Prints a warning to screen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(</strong><strong>string</strong><strong>)</strong> (<em>message</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.UNINDENT">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">UNINDENT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/logger.html#UNINDENT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.UNINDENT" title="Link to this definition"></a></dt>
<dd><p>Unindents the current level of outputs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.logger.getCustomLogger">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.logger.</span></span><span class="sig-name descname"><span class="pre">getCustomLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#selfisys.utils.logger.CustomLogger" title="selfisys.utils.logger.CustomLogger"><span class="pre">CustomLogger</span></a></span></span><a class="reference internal" href="_modules/selfisys/utils/logger.html#getCustomLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.logger.getCustomLogger" title="Link to this definition"></a></dt>
<dd><p>Get as CustomLogger instance to use the custom printing routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the logger.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logger</strong> – The custom logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.low_level">
<span id="selfisys-utils-low-level-module"></span><h2>selfisys.utils.low_level module<a class="headerlink" href="#module-selfisys.utils.low_level" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.low_level.stderr_redirector">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.low_level.</span></span><span class="sig-name descname"><span class="pre">stderr_redirector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/low_level.html#stderr_redirector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.low_level.stderr_redirector" title="Link to this definition"></a></dt>
<dd><p>A context manager that redirects stderr to the given stream.
For instance, this can be used to redirect C code stderr to None (to
avoid cluttering the log, e.g., when using tqdm).</p>
<p>Use with caution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stream</strong> (<em>file-like object</em>) – The stream to which stdout should be
redirected.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.low_level.stdout_redirector">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.low_level.</span></span><span class="sig-name descname"><span class="pre">stdout_redirector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/low_level.html#stdout_redirector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.low_level.stdout_redirector" title="Link to this definition"></a></dt>
<dd><p>A context manager that redirects stdout to the given stream. For
instance, this can be used to redirect C code stdout to None (to
avoid cluttering the log, e.g., when using tqdm).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stream</strong> (<em>file-like object</em>) – The stream to which stdout should be
redirected.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">stdout_redirector</span><span class="p">(</span><span class="n">stream</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">)</span> <span class="c1"># Will be printed to stream</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="c1"># instead of stdout.</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-selfisys.utils.parser">
<span id="selfisys-utils-parser-module"></span><h2>selfisys.utils.parser module<a class="headerlink" href="#module-selfisys.utils.parser" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.bool_sh">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">bool_sh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#bool_sh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.bool_sh" title="Link to this definition"></a></dt>
<dd><p>Convert a string to a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – String to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.check_files_exist">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">check_files_exist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#check_files_exist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.check_files_exist" title="Link to this definition"></a></dt>
<dd><p>Check if all files in the list exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>files</strong> (<em>list</em><em> of </em><em>str</em>) – List of file paths to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all files exist, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.intNone">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">intNone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#intNone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.intNone" title="Link to this definition"></a></dt>
<dd><p>Convert a string to None or int.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – String to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.joinstrs">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">joinstrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_strs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#joinstrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.joinstrs" title="Link to this definition"></a></dt>
<dd><p>Join a list of strings into a single string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list_of_strs</strong> (<em>list</em><em> of </em><em>str</em>) – List of strings to join.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.joinstrs_only">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">joinstrs_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_strs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#joinstrs_only"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.joinstrs_only" title="Link to this definition"></a></dt>
<dd><p>Join a list of strings into a single string, ignoring all
non-string elements such as None values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list_of_strs</strong> (<em>list</em><em> of </em><em>str</em>) – List of strings to join.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.none_or_bool_or_str">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">none_or_bool_or_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#none_or_bool_or_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.none_or_bool_or_str" title="Link to this definition"></a></dt>
<dd><p>Convert a string to None, bool, or str.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – String to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None, bool, or str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.parser.safe_npload">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.parser.</span></span><span class="sig-name descname"><span class="pre">safe_npload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/parser.html#safe_npload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.parser.safe_npload" title="Link to this definition"></a></dt>
<dd><p>Load a numpy array from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to the file to load.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded array or None if the file does not exist.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.path_utils">
<span id="selfisys-utils-path-utils-module"></span><h2>selfisys.utils.path_utils module<a class="headerlink" href="#module-selfisys.utils.path_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.path_utils.file_names_evaluate">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.path_utils.</span></span><span class="sig-name descname"><span class="pre">file_names_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TimeSteps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_mocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/selfisys/utils/path_utils.html#file_names_evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.path_utils.file_names_evaluate" title="Link to this definition"></a></dt>
<dd><p>Generate file paths for the given simulation id and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simdir</strong> (<em>str</em>) – Path to the simulation directory.</p></li>
<li><p><strong>sd</strong> (<em>str</em>) – Path to the simulation directory for the given direction.</p></li>
<li><p><strong>d</strong> (<em>int</em>) – Direction index (-1 for mock data, 0 for the expansion point, or
1 to S).</p></li>
<li><p><strong>i</strong> (<em>int</em>) – Simulation index.</p></li>
<li><p><strong>sim_params</strong> (<em>str</em>) – Simulation parameters.</p></li>
<li><p><strong>TimeSteps</strong> (<em>list</em><em> of </em><em>int</em>) – List of time steps.</p></li>
<li><p><strong>prefix_mocks</strong> (<em>str</em><em> | </em><em>None</em>) – Prefix for mock data files. If None, defaults to “mocks”.</p></li>
<li><p><strong>abc</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, appends the ABC index to the white noise path.</p></li>
<li><p><strong>gravity_on</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether gravity is active. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing simulation inputs / outputs file paths.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.path_utils.get_file_names">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.path_utils.</span></span><span class="sig-name descname"><span class="pre">get_file_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fsimdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TimeSteps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix_mocks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/selfisys/utils/path_utils.html#get_file_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.path_utils.get_file_names" title="Link to this definition"></a></dt>
<dd><p>Generate file paths for a given simulation ID and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fsimdir</strong> (<em>str</em>) – Path to the simulation directory.</p></li>
<li><p><strong>sim_id</strong> (<em>int</em>) – Simulation ID.</p></li>
<li><p><strong>sim_params</strong> (<em>str</em>) – Simulation parameters.</p></li>
<li><p><strong>TimeSteps</strong> (<em>list</em><em> of </em><em>int</em>) – List of time steps.</p></li>
<li><p><strong>prefix_mocks</strong> (<em>str</em><em> | </em><em>None</em>) – Prefix for mock data files. If None, defaults to “mocks”.</p></li>
<li><p><strong>gravity_on</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether gravity is active. Default is True.</p></li>
<li><p><strong>return_g</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return the file name for the observed galaxy field.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing simulation inputs / outputs file paths.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.plot_examples">
<span id="selfisys-utils-plot-examples-module"></span><h2>selfisys.utils.plot_examples module<a class="headerlink" href="#module-selfisys.utils.plot_examples" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_examples.plot_comoving_distance_redshift">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_examples.</span></span><span class="sig-name descname"><span class="pre">plot_comoving_distance_redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">means_com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lcorner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colours_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['C4',</span> <span class="pre">'C5',</span> <span class="pre">'C6',</span> <span class="pre">'C7']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_examples.html#plot_comoving_distance_redshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_examples.plot_comoving_distance_redshift" title="Link to this definition"></a></dt>
<dd><p>Plot comoving distance as a function of redshift, highlighting key
scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zz</strong> (<em>array-like</em>) – Redshift range for the plot.</p></li>
<li><p><strong>cosmo</strong> (<em>astropy.cosmology object</em>) – Cosmology instance for calculating comoving distances.</p></li>
<li><p><strong>means_com</strong> (<em>array-like</em>) – Mean comoving distances of selection functions.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Box side length in Gpc/h.</p></li>
<li><p><strong>Lcorner</strong> (<em>float</em>) – Diagonal of the box (sqrt(3) * L) in Gpc/h.</p></li>
<li><p><strong>wd</strong> (<em>str</em>) – Working directory for saving figures.</p></li>
<li><p><strong>colours_list</strong> (<em>list</em>) – List of colours for selection function annotations.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure. Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_examples.plot_galaxy_field_slice">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_examples.</span></span><span class="sig-name descname"><span class="pre">plot_galaxy_field_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_examples.html#plot_galaxy_field_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_examples.plot_galaxy_field_slice" title="Link to this definition"></a></dt>
<dd><p>Plot a 2D slice of the observed field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<em>ndarray</em>) – 2D array representing the observed field slice.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – Number of grid points along each axis.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Size of the simulation box (in Mpc/h).</p></li>
<li><p><strong>wd</strong> (<em>str</em>) – Working directory for saving output files.</p></li>
<li><p><strong>id_obs</strong> (<em>int</em><em> or </em><em>str</em>) – Identifier for the observation, used in file naming.</p></li>
<li><p><strong>limits</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap scaling method. Options: ‘minmax’, ‘truncate’, ‘max’.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure. Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_examples.plot_power_spectrum">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_examples.</span></span><span class="sig-name descname"><span class="pre">plot_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_sim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planck_Pk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins_bnd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_examples.html#plot_power_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_examples.plot_power_spectrum" title="Link to this definition"></a></dt>
<dd><p>Plot a power spectrum over Fourier modes, its linear interpolation
over specified support points, and a given binning for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G_sim</strong> (<em>pysbmy.power.FourierGrid</em>) – Fourier grid object containing the <cite>k_modes</cite> attribute.</p></li>
<li><p><strong>true_P</strong> (<em>pysbmy.power.PowerSpectrum</em>) – Power spectrum object containing the <cite>powerspectrum</cite> attribute.</p></li>
<li><p><strong>k_s</strong> (<em>array-like</em>) – Support points in k-space.</p></li>
<li><p><strong>planck_Pk</strong> (<em>array-like</em>) – Power spectrum values at the support points.</p></li>
<li><p><strong>Pbins</strong> (<em>array-like</em>) – Centres of the Φ bins in k-space.</p></li>
<li><p><strong>Pbins_bnd</strong> (<em>array-like</em>) – Boundaries of the Φ bins in k-space.</p></li>
<li><p><strong>size</strong> (<em>float</em>) – Box size in number of grid cells.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Box length in Mpc/h.</p></li>
<li><p><strong>wd</strong> (<em>str</em>) – Working directory path for saving the figure.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the figure. Default is None.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_examples.plot_selection_functions_def_in_z">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_examples.</span></span><span class="sig-name descname"><span class="pre">plot_selection_functions_def_in_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx_of_zs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_mis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stds_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_examples.html#plot_selection_functions_def_in_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_examples.plot_selection_functions_def_in_z" title="Link to this definition"></a></dt>
<dd><p>Plot radial lognormal (in redshift) selection functions against
comoving distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx_of_zs</strong> (<em>array-like</em>) – Comoving distances mapped from redshift.</p></li>
<li><p><strong>res</strong> (<em>list</em><em> of </em><em>array-like</em>) – Selection functions for the well-specified model.</p></li>
<li><p><strong>res_mis</strong> (<em>list</em><em> of </em><em>array-like</em>) – Selection functions for the mis-specified model.</p></li>
<li><p><strong>z_means</strong> (<em>array-like</em>) – Mean redshifts of every galaxy population.</p></li>
<li><p><strong>cosmo</strong> (<em>object</em>) – Cosmology object.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Box side length in comoving distance units.</p></li>
<li><p><strong>stds_z</strong> (<em>array-like</em>) – Standard deviations of redshift distributions.</p></li>
<li><p><strong>wd</strong> (<em>str</em>) – Working directory for saving figures.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_examples.redshift_distance_conversion">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_examples.</span></span><span class="sig-name descname"><span class="pre">redshift_distance_conversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">means_com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lcorner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colours_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['C4',</span> <span class="pre">'C5',</span> <span class="pre">'C6',</span> <span class="pre">'C7']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_examples.html#redshift_distance_conversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_examples.redshift_distance_conversion" title="Link to this definition"></a></dt>
<dd><p>Plot the conversion between comoving distance and redshift; return
the redshifts corresponding to the selection functions’ means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zz</strong> (<em>array-like</em>) – Redshift range for the plot.</p></li>
<li><p><strong>cosmo</strong> (<em>astropy.cosmology object</em>) – Cosmology instance for calculating comoving distances.</p></li>
<li><p><strong>means_com</strong> (<em>array-like</em>) – Mean comoving distances of selection functions.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Box side length in Gpc/h.</p></li>
<li><p><strong>Lcorner</strong> (<em>float</em>) – Diagonal of the box (sqrt(3) * L) in Gpc/h.</p></li>
<li><p><strong>xx</strong> (<em>array-like</em>) – Comoving distances at which to compute redshift.</p></li>
<li><p><strong>wd</strong> (<em>str</em>) – Working directory for saving figures.</p></li>
<li><p><strong>colours_list</strong> (<em>list</em>) – List of colours for selection function annotations.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>spline</strong> – Linear interpolator to convert comoving distances to redshifts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scipy.interpolate.UnivariateSpline</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_examples.relative_error_analysis">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_examples.</span></span><span class="sig-name descname"><span class="pre">relative_error_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G_sim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planck_Pk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins_bnd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_examples.html#relative_error_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_examples.relative_error_analysis" title="Link to this definition"></a></dt>
<dd><p>Compute and plot the relative error between the interpolated and
true power spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G_sim</strong> (<em>pysbmy.power.FourierGrid</em>) – Fourier grid object containing the <cite>k_modes</cite> attribute.</p></li>
<li><p><strong>true_P</strong> (<em>pysbmy.power.PowerSpectrum</em>) – Power spectrum object containing the <cite>powerspectrum</cite> attribute.</p></li>
<li><p><strong>k_s</strong> (<em>array-like</em>) – Support points in k-space.</p></li>
<li><p><strong>planck_Pk</strong> (<em>array-like</em>) – Power spectrum values at the support points.</p></li>
<li><p><strong>Pbins</strong> (<em>array-like</em>) – Centres of the Φ bins in k-space.</p></li>
<li><p><strong>Pbins_bnd</strong> (<em>array-like</em>) – Boundaries of the Φ bins in k-space.</p></li>
<li><p><strong>size</strong> (<em>float</em>) – Box size in number of grid cells.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Box length in Mpc/h.</p></li>
<li><p><strong>wd</strong> (<em>str</em>) – Working directory path for saving the figure.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the figure. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.plot_params">
<span id="selfisys-utils-plot-params-module"></span><h2>selfisys.utils.plot_params module<a class="headerlink" href="#module-selfisys.utils.plot_params" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.ScalarFormatterForceFormat_11">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">ScalarFormatterForceFormat_11</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">useOffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useMathText</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">useLocale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#ScalarFormatterForceFormat_11"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom scalar formatter to enforce a specific number format with an
offset.</p>
<p>This formatter displays tick labels with one decimal place and
includes the offset notation for powers of ten.</p>
<dl class="py method">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.ScalarFormatterForceFormat_11.get_offset">
<span class="sig-name descname"><span class="pre">get_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#ScalarFormatterForceFormat_11.get_offset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11.get_offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.ScalarFormatterForceFormat_11.set_scientific">
<span class="sig-name descname"><span class="pre">set_scientific</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#ScalarFormatterForceFormat_11.set_scientific"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11.set_scientific" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.ScalarFormatterForceFormat_11.set_useOffset">
<span class="sig-name descname"><span class="pre">set_useOffset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#ScalarFormatterForceFormat_11.set_useOffset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.ScalarFormatterForceFormat_11.set_useOffset" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.create_all_colormaps">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">create_all_colormaps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#create_all_colormaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.create_all_colormaps" title="Link to this definition"></a></dt>
<dd><p>Create all custom colormaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>colormaps</strong> – Dictionary containing all custom colormaps.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.create_colormap">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">create_colormap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#create_colormap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.create_colormap" title="Link to this definition"></a></dt>
<dd><p>Create a custom colormap based on the specified name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the colormap to create.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested custom colormap.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ListedColormap</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the specified colormap name is not recognised.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.dynamic_text_scaling">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">dynamic_text_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig_height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#dynamic_text_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.dynamic_text_scaling" title="Link to this definition"></a></dt>
<dd><p>Dynamically scale text sizes based on the vertical height of the
figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fig_height</strong> (<em>float</em>) – Height of the figure in inches.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of scaled font sizes for consistent appearance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.get_contours">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">get_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confLevels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.3173,</span> <span class="pre">0.0455,</span> <span class="pre">0.0027)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#get_contours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.get_contours" title="Link to this definition"></a></dt>
<dd><p>Compute contour levels for given confidence levels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Z</strong> (<em>ndarray</em>) – 2D histogram or density estimate.</p></li>
<li><p><strong>nBins</strong> (<em>int</em>) – Number of bins along one axis.</p></li>
<li><p><strong>confLevels</strong> (<em>tuple</em><em> of </em><em>float</em>) – Confidence levels for which to compute contour levels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>chainLevels</strong> – Contour levels corresponding to the provided confidence levels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.reset_plotting">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">reset_plotting</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#reset_plotting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.reset_plotting" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_params.setup_plotting">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_params.</span></span><span class="sig-name descname"><span class="pre">setup_plotting</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_params.html#setup_plotting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_params.setup_plotting" title="Link to this definition"></a></dt>
<dd><p>Configure Matplotlib plotting settings for consistent appearance.</p>
</dd></dl>

</section>
<section id="module-selfisys.utils.plot_utils">
<span id="selfisys-utils-plot-utils-module"></span><h2>selfisys.utils.plot_utils module<a class="headerlink" href="#module-selfisys.utils.plot_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_C">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CMap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_C" title="Link to this definition"></a></dt>
<dd><p>Plot covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_0</strong> (<em>ndarray</em>) – Covariance matrix.</p></li>
<li><p><strong>X</strong> (<em>ndarray</em>) – X-axis grid for plotting.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em>) – Y-axis grid for plotting.</p></li>
<li><p><strong>Pbins</strong> (<em>ndarray</em>) – Vector of bin boundaries for the summary statistics.</p></li>
<li><p><strong>CMap</strong> (<em>str</em>) – Colormap for the plot.</p></li>
<li><p><strong>binning</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overlay bin lines on the plot. Default is True.</p></li>
<li><p><strong>suptitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the plot. If None, a default title is used.</p></li>
<li><p><strong>savepath</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot. If None, the plot is displayed.</p></li>
<li><p><strong>force</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot even if savepath is specified.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_fisher">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_fisher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_names_fisher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_fisher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_fisher" title="Link to this definition"></a></dt>
<dd><p>Plot the Fisher matrix as a heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>F0</strong> (<em>ndarray</em>) – Fisher matrix.</p></li>
<li><p><strong>params_names_fisher</strong> (<em>list</em><em> of </em><em>str</em>) – Names for the axes.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title of the plot. Default is “Fisher matrix”.</p></li>
<li><p><strong>path</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot. If None, the plot is displayed.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_gradients">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_16_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_32_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_48_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_gradients" title="Link to this definition"></a></dt>
<dd><p>Plot gradients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Pbins</strong> (<em>ndarray</em>) – Vector of bin boundaries for the summary statistics.</p></li>
<li><p><strong>P</strong> (<em>int</em>) – Number of bins.</p></li>
<li><p><strong>df_16_full</strong> (<em>ndarray</em>) – Derivative with respect to the 16th input.</p></li>
<li><p><strong>df_32_full</strong> (<em>ndarray</em>) – Derivative with respect to the 32nd input.</p></li>
<li><p><strong>df_48_full</strong> (<em>ndarray</em>) – Derivative with respect to the 48th input.</p></li>
<li><p><strong>df_full</strong> (<em>ndarray</em>) – Full derivative.</p></li>
<li><p><strong>k_s</strong> (<em>ndarray</em>) – Wavenumbers.</p></li>
<li><p><strong>X</strong> (<em>ndarray</em>) – X-axis grid.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em>) – Y-axis grid.</p></li>
<li><p><strong>fixscale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Fix the y-axis scale. Default is False.</p></li>
<li><p><strong>force</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display plot even if savepath is set.</p></li>
<li><p><strong>suptitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the plot.</p></li>
<li><p><strong>savepath</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot. If None, the plot is displayed.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_histogram">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recmahal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blue'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_histogram" title="Link to this definition"></a></dt>
<dd><p>Plot a Mahalanobis distance histogram with key reference lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array-like</em>) – Collection of Mahalanobis distances.</p></li>
<li><p><strong>recmahal</strong> (<em>float</em>) – Single Mahalanobis distance for the reconstruction
(e.g. posterior vs. prior mean).</p></li>
<li><p><strong>suptitle</strong> (<em>str</em>) – Figure title.</p></li>
<li><p><strong>savepath</strong> (<em>str</em>) – Full path (including filename) to save the resulting plot.</p></li>
<li><p><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bins for the histogram. Default is 30.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency level for the histogram bars. Default is 0.5.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Colour of the histogram bars. Default is “blue”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>OSError</strong> – If the file cannot be saved to the specified path.</p></li>
<li><p><strong>RuntimeError</strong> – For unexpected plotting failures.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_mocks">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_mocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NORM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phi_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CMap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_mocks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_mocks" title="Link to this definition"></a></dt>
<dd><p>Plot mocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>NORM</strong> (<em>float</em>) – Normalisation factor.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of mocks.</p></li>
<li><p><strong>P</strong> (<em>int</em>) – Number of bins.</p></li>
<li><p><strong>Pbins</strong> (<em>ndarray</em>) – Vector of bin boundaries for the summary statistics.</p></li>
<li><p><strong>phi_obs</strong> (<em>ndarray</em>) – Observed power spectrum.</p></li>
<li><p><strong>Phi_0</strong> (<em>ndarray</em>) – Mock power spectra.</p></li>
<li><p><strong>f_0</strong> (<em>ndarray</em>) – Averaged power spectrum.</p></li>
<li><p><strong>C_0</strong> (<em>ndarray</em>) – Covariance matrix.</p></li>
<li><p><strong>X</strong> (<em>ndarray</em>) – X-axis grid.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em>) – Y-axis grid.</p></li>
<li><p><strong>CMap</strong> (<em>str</em>) – Colormap.</p></li>
<li><p><strong>suptitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the plot.</p></li>
<li><p><strong>force_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display plot even if savepath is set.</p></li>
<li><p><strong>savepath</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot. If None, the plot is displayed.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_mocks_compact">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_mocks_compact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NORM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phi_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_mocks_compact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_mocks_compact" title="Link to this definition"></a></dt>
<dd><p>Plot and compare observed and simulated power spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>NORM</strong> (<em>float</em>) – Normalisation factor for the observed spectra.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of mock data realisations.</p></li>
<li><p><strong>P</strong> (<em>int</em>) – Number of bins for the summaries.</p></li>
<li><p><strong>Pbins</strong> (<em>ndarray</em>) – Vector of bin boundaries for the summary statistics.</p></li>
<li><p><strong>phi_obs</strong> (<em>ndarray</em>) – Observed power spectrum.</p></li>
<li><p><strong>Phi_0</strong> (<em>ndarray</em>) – Mock realisations of the power spectrum.</p></li>
<li><p><strong>f_0</strong> (<em>ndarray</em>) – Mean power spectrum.</p></li>
<li><p><strong>C_0</strong> (<em>ndarray</em>) – Covariance matrix of the mock summaries.</p></li>
<li><p><strong>suptitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the plot.</p></li>
<li><p><strong>force_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot even if a path is specified.</p></li>
<li><p><strong>savepath</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If an unexpected error occurs during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_observations">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_gt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planck_Pk_EH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Npop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_observations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_observations" title="Link to this definition"></a></dt>
<dd><p>Plot the observed power spectra and related quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_s</strong> (<em>ndarray</em>) – Array of wavenumbers.</p></li>
<li><p><strong>theta_gt</strong> (<em>ndarray</em>) – Ground truth theta values.</p></li>
<li><p><strong>planck_Pk_EH</strong> (<em>ndarray</em>) – Planck power spectrum values.</p></li>
<li><p><strong>P_0</strong> (<em>float</em>) – Normalisation constant for power spectra.</p></li>
<li><p><strong>Pbins</strong> (<em>ndarray</em>) – Vector of bin boundaries for the summary statistics.</p></li>
<li><p><strong>phi_obs</strong> (<em>ndarray</em>) – Observed summaries.</p></li>
<li><p><strong>Npop</strong> (<em>int</em>) – Number of populations.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to save the output plot.</p></li>
<li><p><strong>force_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot even if a path is specified.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_prior_and_posterior_covariances">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_prior_and_posterior_covariances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_theta_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_theta_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_prior_and_posterior_covariances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_prior_and_posterior_covariances" title="Link to this definition"></a></dt>
<dd><p>Plot prior and posterior covariance matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – X-axis grid.</p></li>
<li><p><strong>Y</strong> (<em>ndarray</em>) – Y-axis grid.</p></li>
<li><p><strong>k_s</strong> (<em>ndarray</em>) – Wavenumbers.</p></li>
<li><p><strong>prior_theta_covariance</strong> (<em>ndarray</em>) – Prior covariance matrix for normalised spectra.</p></li>
<li><p><strong>prior_covariance</strong> (<em>ndarray</em>) – Prior covariance matrix for unnormalised spectra.</p></li>
<li><p><strong>posterior_theta_covariance</strong> (<em>ndarray</em>) – Posterior covariance matrix for normalised spectra.</p></li>
<li><p><strong>P_0</strong> (<em>ndarray</em>) – Fiducial power spectrum used for normalisation.</p></li>
<li><p><strong>force_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display plot even if savepath is set.</p></li>
<li><p><strong>suptitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the plot.</p></li>
<li><p><strong>savepath</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot. If None, the plot is displayed.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level (0=silent, 1=default, 2=detailed).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_reconstruction">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_theta_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_theta_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_theta_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior_theta_covariance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_gt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suptitle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_fid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_ylims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_reconstruction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_reconstruction" title="Link to this definition"></a></dt>
<dd><p>Plot the prior, posterior and ground truth power spectra.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_s</strong> (<em>ndarray</em>) – Array of wavenumbers.</p></li>
<li><p><strong>Pbins</strong> (<em>ndarray</em>) – Vector of bin boundaries for the summary statistics.</p></li>
<li><p><strong>prior_theta_mean</strong> (<em>ndarray</em>) – Mean of the prior distribution.</p></li>
<li><p><strong>prior_theta_covariance</strong> (<em>ndarray</em>) – Covariance of the prior distribution.</p></li>
<li><p><strong>posterior_theta_mean</strong> (<em>ndarray</em>) – Mean of the posterior distribution.</p></li>
<li><p><strong>posterior_theta_covariance</strong> (<em>ndarray</em>) – Covariance of the posterior distribution.</p></li>
<li><p><strong>theta_gt</strong> (<em>ndarray</em>) – Ground truth power spectrum.</p></li>
<li><p><strong>P_0</strong> (<em>float</em>) – Normalisation constant for the power spectrum.</p></li>
<li><p><strong>phi_obs</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Observed summaries.</p></li>
<li><p><strong>suptitle</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. Leave empty for no title.</p></li>
<li><p><strong>theta_fid</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Fiducial theta for hyperparameter tuning (for some priors).</p></li>
<li><p><strong>savepath</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) – Path to save the plot.</p></li>
<li><p><strong>force_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot even if a path is specified.</p></li>
<li><p><strong>legend_loc</strong> (<em>str</em><em>, </em><em>optional</em>) – Location of the plot legend.</p></li>
<li><p><strong>enforce_ylims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enforce y-axis limits.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plot_selection_functions">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_selection_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_mis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corner</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'com'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zcorner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labsAB</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plot_selection_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plot_selection_functions" title="Link to this definition"></a></dt>
<dd><p>Plot selection functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – x-axis values (e.g., comoving distances or redshifts).</p></li>
<li><p><strong>res</strong> (<em>list</em><em> of </em><em>array-like</em>) – Selection functions for Model A.</p></li>
<li><p><strong>res_mis</strong> (<em>list</em><em> of </em><em>array-like</em><em>, </em><em>optional</em>) – Selection functions for Model B (optional).</p></li>
<li><p><strong>params</strong> (<em>tuple</em><em> of </em><em>(</em><em>array-like</em><em>, </em><em>array-like</em><em>, </em><em>array-like</em><em>)</em><em>, </em><em>optional</em>) – Standard deviations, means, and normalisation factors for the
multiple galaxy populations.</p></li>
<li><p><strong>L</strong> (<em>float</em>) – Box size.</p></li>
<li><p><strong>corner</strong> (<em>float</em>) – Diagonal box size.</p></li>
<li><p><strong>axis</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis type (‘com’ for comoving distance, ‘redshift’ for
redshift).</p></li>
<li><p><strong>zz</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Mapping between comoving distances and redshifts.</p></li>
<li><p><strong>zcorner</strong> (<em>float</em><em>, </em><em>optional</em>) – Redshift corresponding to the diagonal box size.</p></li>
<li><p><strong>z_L</strong> (<em>float</em><em>, </em><em>optional</em>) – Redshift corresponding to the box side length.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to save the output plot.</p></li>
<li><p><strong>force_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot even if a path is specified.</p></li>
<li><p><strong>labsAB</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, labels models as ‘Model A’ and ‘Model B’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If unexpected errors occur during plotting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.plot_utils.plotly_3d">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plotly_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdYlBu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/plot_utils.html#plotly_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.plot_utils.plotly_3d" title="Link to this definition"></a></dt>
<dd><p>Create an interactive 3D plot of volume slices using Plotly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field</strong> (<em>array-like</em>) – 3D data field to visualise.</p></li>
<li><p><strong>size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the field along one dimension. Default is 128.</p></li>
<li><p><strong>L</strong> (<em>float</em><em>, </em><em>optional</em>) – Physical size of the field in Mpc/h. Used for axis labels only.</p></li>
<li><p><strong>colormap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colour map for visualisation. Default is ‘RdYlBu’.</p></li>
<li><p><strong>limits</strong> (<em>str</em><em>, </em><em>optional</em>) – Colour scale limits (‘max’, ‘truncate’, or ‘default’). Default
is ‘max’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Plotly figure object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>go.Figure</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.timestepping">
<span id="selfisys-utils-timestepping-module"></span><h2>selfisys.utils.timestepping module<a class="headerlink" href="#module-selfisys.utils.timestepping" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.timestepping.merge_nTS">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.timestepping.</span></span><span class="sig-name descname"><span class="pre">merge_nTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merged_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/timestepping.html#merge_nTS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.timestepping.merge_nTS" title="Link to this definition"></a></dt>
<dd><p>Merge multiple time-stepping objects into a single file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts_path_list</strong> (<em>list</em><em> of </em><em>str</em>) – Paths to the individual time-stepping files to be merged.</p></li>
<li><p><strong>merged_path</strong> (<em>str</em>) – Path to save the merged time-stepping file.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.tools">
<span id="selfisys-utils-tools-module"></span><h2>selfisys.utils.tools module<a class="headerlink" href="#module-selfisys.utils.tools" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.cosmo_vector_to_Simbelmyne_dict">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">cosmo_vector_to_Simbelmyne_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#cosmo_vector_to_Simbelmyne_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.cosmo_vector_to_Simbelmyne_dict" title="Link to this definition"></a></dt>
<dd><p>Convert a vector of cosmological parameters into a dictionary
compatible with <cite>pysbmy</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Vector of cosmological parameters.</p></li>
<li><p><strong>kmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavenumber for the power spectrum computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of cosmological parameters compatible with <cite>pysbmy</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.cosmo_vector_to_class_dict">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">cosmo_vector_to_class_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#cosmo_vector_to_class_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.cosmo_vector_to_class_dict" title="Link to this definition"></a></dt>
<dd><p>Convert a vector of cosmological parameters into a dictionary
compatible with <cite>classy</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Vector of cosmological parameters.</p></li>
<li><p><strong>lmax</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum multipole for the power spectrum computation.</p></li>
<li><p><strong>kmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavenumber for the power spectrum computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of cosmological parameters compatible with <cite>classy</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.custom_stat">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">custom_stat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#custom_stat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.custom_stat" title="Link to this definition"></a></dt>
<dd><p>Compute a custom statistic for use with
<cite>scipy.stats.binned_statistic</cite>.</p>
<p>Assumes the data power spectrum is inverse-Gamma distributed (as in
[jasche2010bayesian] and [leclercq2019primordial]). Returns “NaN”
for vectors with insufficient elements, as expected by
<cite>scipy.stats.binned_statistic</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vec</strong> (<em>array-like</em>) – Input vector for computation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Custom statistic or NaN if input is invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.fisher_rao">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">fisher_rao</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Com_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#fisher_rao"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.fisher_rao" title="Link to this definition"></a></dt>
<dd><p>Compute the Fisher-Rao distance between two summaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Com</strong> (<em>array-like</em>) – Computed summary.</p></li>
<li><p><strong>Com_obs</strong> (<em>array-like</em>) – Observed summary.</p></li>
<li><p><strong>F0</strong> (<em>array-like</em>) – Fisher information matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fisher-Rao distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.get_k_max">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">get_k_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#get_k_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.get_k_max" title="Link to this definition"></a></dt>
<dd><p>Compute the maximum wavenumber for a given box size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>float</em>) – Size of the box in Mpc/h.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – Number of grid cells along each dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum wavenumber in h/Mpc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.get_summary">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">get_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Omegas_fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalisation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#get_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.get_summary" title="Link to this definition"></a></dt>
<dd><p>Compute the normalised power spectrum summary for a given parameter
set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_vals</strong> (<em>array-like</em>) – Parameter values to update.</p></li>
<li><p><strong>params_ids</strong> (<em>array-like</em>) – Indices of the parameters to update.</p></li>
<li><p><strong>Omegas_fixed</strong> (<em>array-like</em>) – Fixed base values of parameters.</p></li>
<li><p><strong>bins</strong> (<em>array-like</em>) – Power spectrum bins.</p></li>
<li><p><strong>normalisation</strong> (<em>float</em><em>, </em><em>optional</em>) – Normalisation factor for the summary.</p></li>
<li><p><strong>kmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavenumber for power spectrum computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised power spectrum summary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.none_or_bool_or_str">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">none_or_bool_or_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#none_or_bool_or_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.none_or_bool_or_str" title="Link to this definition"></a></dt>
<dd><p>Convert string representations of None, True, and False to their
respective Python objects; otherwise, return the input value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.params_ids_to_Simbelmyne_dict">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">params_ids_to_Simbelmyne_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#params_ids_to_Simbelmyne_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.params_ids_to_Simbelmyne_dict" title="Link to this definition"></a></dt>
<dd><p>Convert a list of cosmological parameters into a dictionary
compatible with <cite>pysbmy</cite>.</p>
<p>Fixed parameters remain unchanged unless overridden by
<cite>params_vals</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_vals</strong> (<em>array-like</em>) – Values of the parameters to be modified.</p></li>
<li><p><strong>params_ids</strong> (<em>array-like</em>) – Indices of the parameters to be modified.</p></li>
<li><p><strong>fixed</strong> (<em>array-like</em>) – Base values of the parameters.</p></li>
<li><p><strong>kmax</strong> (<em>float</em>) – Maximum wavenumber for the power spectrum computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of cosmological parameters compatible with <cite>pysbmy</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.sample_omega_from_prior">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">sample_omega_from_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#sample_omega_from_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.sample_omega_from_prior" title="Link to this definition"></a></dt>
<dd><p>Sample cosmological parameters from a prior distribution.</p>
<p>Ensures physical validity by clipping values to [eps, 1-eps].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsample</strong> (<em>int</em>) – Number of samples to draw.</p></li>
<li><p><strong>omega_mean</strong> (<em>array-like</em>) – Prior mean vector.</p></li>
<li><p><strong>omega_cov</strong> (<em>array-like</em>) – Prior covariance matrix.</p></li>
<li><p><strong>params_ids</strong> (<em>array-like</em>) – Indices of the parameters to sample.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for the random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sampled cosmological parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.tools.summary_to_score">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.tools.</span></span><span class="sig-name descname"><span class="pre">summary_to_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F0_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dw_f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C0_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/tools.html#summary_to_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.tools.summary_to_score" title="Link to this definition"></a></dt>
<dd><p>Compute the Fisher score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_ids</strong> (<em>array-like</em>) – Indices of the parameters.</p></li>
<li><p><strong>omega0</strong> (<em>array-like</em>) – Cosmological parameters at the expansion point.</p></li>
<li><p><strong>F0</strong> (<em>array-like</em>) – Fisher information matrix.</p></li>
<li><p><strong>F0_inv</strong> (<em>array-like</em>) – Inverse Fisher information matrix.</p></li>
<li><p><strong>f0</strong> (<em>array-like</em>) – Mean model at the expansion point.</p></li>
<li><p><strong>dw_f0</strong> (<em>array-like</em>) – Derivative of the mean model.</p></li>
<li><p><strong>C0_inv</strong> (<em>array-like</em>) – Inverse covariance matrix.</p></li>
<li><p><strong>phi</strong> (<em>array-like</em>) – Observed summary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fisher score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils.workers">
<span id="selfisys-utils-workers-module"></span><h2>selfisys.utils.workers module<a class="headerlink" href="#module-selfisys.utils.workers" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.workers.Simbelmyne_worker">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.workers.</span></span><span class="sig-name descname"><span class="pre">Simbelmyne_worker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/selfisys/utils/workers.html#Simbelmyne_worker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.workers.Simbelmyne_worker" title="Link to this definition"></a></dt>
<dd><p>Worker function used for implicit likelihood inference of
cosmological parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>tuple</em>) – A tuple of arguments to be unpacked for the worker routine:
(index, param_val, param_id, fsimdir, k_s, Pbins_bnd,
selection_params, norm_csts, P_ss_obj_path, obs_density,
lin_bias, noise, survey_mask_path, G_sim_path, G_ss_path, Np0,
Npm0, seedphase_init, seednoise_init, size, L,
radial_selection, sim_params, wd, batch_idx, dbg, modeldir,
local_mask_prefix, TimeStepDistribution, indices_steps_cumul,
eff_redshifts, poolname_abc, setup_only, prefix_mocks).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(param_val, Phi) where param_val is the parameter value used,
and Phi is the resulting summary from evaluating the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>OSError</strong> – If file I/O (reading or writing mock data) fails.</p></li>
<li><p><strong>RuntimeError</strong> – For unexpected errors in the worker routine.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.workers.evaluate_gradient_of_Symbelmyne">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.workers.</span></span><span class="sig-name descname"><span class="pre">evaluate_gradient_of_Symbelmyne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0.6666666666666666,</span> <span class="pre">-0.08333333333333333]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltas_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.02]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/workers.html#evaluate_gradient_of_Symbelmyne"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.workers.evaluate_gradient_of_Symbelmyne" title="Link to this definition"></a></dt>
<dd><p>Estimate the gradient of CLASS with respect to the cosmological
parameters using central finite differences of arbitrary order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega</strong> (<em>ndarray</em>) – Base cosmological parameter vector.</p></li>
<li><p><strong>param_index</strong> (<em>int</em>) – Index of the parameter to differentiate against.</p></li>
<li><p><strong>k_s</strong> (<em>ndarray</em>) – Wavenumbers for the power spectrum.</p></li>
<li><p><strong>coeffs</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Coefficients for the finite-difference scheme, typically
[2/3, -1/12] etc. Default is [2/3.0, -1/12.0].</p></li>
<li><p><strong>deltas_x</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Step sizes. The corresponding negative steps are generated
automatically. Default is [0.01, 0.02].</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – Scale for the finite difference in the denominator. Default is
1e-2.</p></li>
<li><p><strong>kmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum wavenumber for the power spectrum. Default is 1.4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gradient of the power spectrum wrt the specified parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the gradient evaluation fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="selfisys.utils.workers.worker_gradient_Symbelmyne">
<span class="sig-prename descclassname"><span class="pre">selfisys.utils.workers.</span></span><span class="sig-name descname"><span class="pre">worker_gradient_Symbelmyne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selfisys/utils/workers.html#worker_gradient_Symbelmyne"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selfisys.utils.workers.worker_gradient_Symbelmyne" title="Link to this definition"></a></dt>
<dd><p>Worker function for evaluating the gradient of the power spectrum
using finite differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff</strong> (<em>float</em>) – Coefficient for the finite difference.</p></li>
<li><p><strong>delta_x</strong> (<em>float</em>) – Step size in the parameter space.</p></li>
<li><p><strong>omega</strong> (<em>ndarray</em>) – Base cosmological parameter vector.</p></li>
<li><p><strong>param_index</strong> (<em>int</em>) – Index of the parameter being varied.</p></li>
<li><p><strong>k_s</strong> (<em>ndarray</em>) – Array of wavenumbers.</p></li>
<li><p><strong>delta</strong> (<em>float</em>) – Denominator for finite differences (scaled).</p></li>
<li><p><strong>kmax</strong> (<em>float</em>) – Maximum wavenumber for power spectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gradient of the power spectrum wrt the specified parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the gradient evaluation fails.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-selfisys.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-selfisys.utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="selfisys.grf.html" class="btn btn-neutral float-left" title="grf" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CONTRIBUTING.html" class="btn btn-neutral float-right" title="Contributing to SelfiSys" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Tristan Hoellinger.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>